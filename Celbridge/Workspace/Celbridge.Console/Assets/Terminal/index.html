<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Xterm</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm/css/xterm.css">
    <script src="https://cdn.jsdelivr.net/npm/xterm/lib/xterm.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-fit@0.10.0/lib/addon-fit.js"></script>

    <style>
        html, body {
            margin: 0;
            height: 100%;
            width: 100%;
            background: black;
            overflow: hidden;
        }

        #terminal {
            height: 100vh;
            width: 100%;
        }
    </style>
</head>
<body>
    <div id="terminal"></div>

    <script>

        const campbellTheme = {
            foreground: '#CCCCCC',
            background: '#0C0C0C',
            cursor: '#FFFFFF',
            selection: '#FFFFFF40',

            black: '#0C0C0C',
            red: '#C50F1F',
            green: '#13A10E',
            yellow: '#C19C00',
            blue: '#0037DA',
            magenta: '#881798',
            cyan: '#3A96DD',
            white: '#CCCCCC',

            brightBlack: '#767676',
            brightRed: '#E74856',
            brightGreen: '#16C60C',
            brightYellow: '#F9F1A5',
            brightBlue: '#3B78FF',
            brightMagenta: '#B4009E',
            brightCyan: '#61D6D6',
            brightWhite: '#F2F2F2'
        };

        const term = new Terminal({
            theme: campbellTheme
        });

        const fitAddon = new FitAddon.FitAddon();
        term.loadAddon(fitAddon);

        term.open(document.getElementById('terminal'));
        fitAddon.fit();

        window.addEventListener('resize', () => {
            fitAddon.fit();
        });

        // Send terminal input to host
        term.onData(data => {
            window.chrome.webview.postMessage(data);
        });

        // Receive data from host and write to terminal
        window.chrome.webview.addEventListener('message', event => {
            const data = event.data;
            if (typeof data === "string") {
                term.write(data);
            }
        });
    </script>
</body>
</html>
